# \[Day64] 25.08.14 배운 내용 정리

---

[수업시간 실습 코드 바로가기: Day62](../Day62-next-awsmongo/day62-next/)

---

## Page Router

> Page Router는 **파일 시스템 라우터**를 사용하여 각 파일을 경로에 매핑합니다.  
> Next.js 13 이전에는 Page Router가 경로 생성의 주 방법이었으나, 현재는 React 최신 기능을 활용하기 위해 **App Router** 사용이 권장됩니다.  
> 구조와 차이점은 [Day57 정리](https://github.com/Ahhhhhhyeong/goorm-deep-dive-frontend4/tree/main/src/Day57-next#page-router--app-router)를 참고하세요.

---

## Page Router Data Fetching 메서드와 주요 기능

### 1. `getStaticProps` (SSG — Static Site Generation)

- **동작 시점**: 빌드 시에 한 번 실행되어 정적 파일을 생성합니다. 이후에는 서버 요청 없이 빠르게 제공됩니다.
- **용도**: 데이터가 자주 바뀌지 않고, SEO 최적화나 빠른 로딩이 필요한 페이지에 적합합니다 (예: 블로그, 소개 페이지 등).
- **장점**: 페이지 속도가 매우 빠르고 CDN 캐싱이 가능해 성능 최적화에 유리합니다.
- **추가 기능 (`revalidate`)**: ISR(Incremental Static Regeneration)을 통해 일정 주기마다 페이지를 자동 재생성할 수 있습니다.
- **기타 옵션**: `redirect`, `notFound` 등을 함께 반환하여 리다이렉션이나 404 처리도 지원합니다.

---

### 2. `getStaticPaths`

- **사용 상황**: 페이지에 **동적 라우팅**이 있을 경우, 어떤 경로들을 빌드 시점에 미리 생성할지 지정하는 함수입니다.
- **반환 값**:

  - `paths`: 사전 생성할 경로의 리스트 (예: `[ { params: { id: '1' } }, ... ]`)
  - `fallback`: `'false'`, `'true'`, 또는 `'blocking'` 중 선택 가능하는 모드

- **Fallback 모드 설명** (Next.js 동작 방식):

  - **`false`**: 미리 정의되지 않은 경로는 404.
  - **`true`**: 최초 접근 시 fallback 페이지 제공 후, 백그라운드에서 HTML/JSON 생성. 이후 정적 페이지로 제공됨.
  - **`'blocking'`**: 최초 요청 시 서버에서 렌더링 후 응답. 이후에는 정적 페이지처럼 제공됨—로딩 플래시는 없음.

- **유용한 상황**: e-커머스 같은 매우 많은 동적 페이지를 효율적으로 처리하고 싶을 때 유용합니다.

---

### 3. `getServerSideProps` (SSR — Server-Side Rendering)

- **동작 시점**: **매 요청마다** 서버에서 실행되어 최신 데이터를 받아와 렌더링한 HTML을 응답합니다.
- **용도**: 실시간 데이터, 사용자 맞춤형 콘텐츠, 로그인 기반 대시보드 등, 항상 최신 데이터가 필요한 페이지에 적합합니다.
- **단점**: 매 요청 시 렌더링이 발생하므로 상대적으로 느릴 수 있고, CDN 캐싱이 어렵습니다.

---

### 메서드 비교 표

| 메서드               | 실행 시점  | 데이터 특성         | 성능/CND 효과               | 주요 용도                              |
| -------------------- | ---------- | ------------------- | --------------------------- | -------------------------------------- |
| `getStaticProps`     | 빌드 타임  | 고정 또는 변동 적음 | 매우 빠름 / 캐시 가능       | 블로그, 마케팅 페이지 등               |
| `getStaticPaths`     | 빌드 타임  | 동적 라우팅 처리    | SSG와 함께 사용             | 다수 동적 페이지(예: 상품 목록) 처리   |
| `getServerSideProps` | 매 요청 시 | 항상 최신           | 상대적으로 느림 / 캐시 불가 | 로그인 기반 페이지, 실시간 대시보드 등 |

---

### 언제 무엇을 사용할까?

- **변하지 않는 정보 중심 페이지** → `getStaticProps`
- **다수의 동적 페이지 중 일부만 빌드하고 필요 시 생성** → `getStaticPaths` + `getStaticProps`
- **매 요청마다 최신 데이터를 반영해야 하는 페이지** → `getServerSideProps`

---
